#  Nonparametric link prediction in dynamic networks

> https://arxiv.org/pdf/1206.6394
> Sarkar, P., Chakrabarti, D., & Jordan, M. (2012).arXiv preprint arXiv:1206.6394.

### **核心内容**：

1. **问题背景**：
   - 链接预测是图分析中的重要任务，例如社交网络的好友推荐、用户行为预测等。
   - 现有方法主要依赖静态图或基于启发式规则，缺乏理论保障或处理时间序列动态的能力。

2. **方法创新**：
   - **非参数建模**：提出了一种非参数模型，通过节点及其局部邻域的特征，预测动态网络中可能形成的链接。
   - **一致性证明**：利用强混合假设和核估计理论，证明了该方法的估计一致性。
   - **高效实现**：采用局部敏感哈希（LSH）方法实现快速的近邻搜索，提高大规模图计算效率。

3. **实验结果**：
   - 使用仿真数据和五个真实动态图验证方法的有效性，包括传感器网络、合作网络和股市数据。
   - 结果表明，该方法在存在非线性变化（如季节性波动）时表现尤为优越。

4. **贡献总结**：
   - 首次提出了非参数的动态网络链接预测模型，可处理复杂动态并整合外部特征。
   - 模型在多个领域的数据集上表现优异，具有良好的理论和实用性。

---

### **结构概述**：
- **引言**：介绍链接预测背景及现有方法的局限性。
- **方法**：详细阐述了非参数建模方法及一致性证明。
- **实现**：提出利用局部敏感哈希优化核回归的高效实现。
- **实验**：对比分析新方法与现有基准方法的性能表现。
- **相关工作与结论**：回顾相关研究并总结优势与未来展望。

---

本文要解决的问题是 **动态网络中的链接预测问题**。具体来说，链接预测是指在图（网络）中预测未来可能会出现的边（链接）。该问题在诸多领域都有实际应用，例如：

1. **社交网络**：推荐好友或建立可能的社会关系。
2. **推荐系统**：预测用户可能感兴趣的内容（例如电影、书籍、商品）。
3. **生物网络**：预测分子或基因之间的潜在相互作用。
4. **市场分析**：预测商业网络中可能的新合作关系。

---

### **问题的特殊挑战**
动态网络中的链接预测有以下独特的挑战，这也是本文试图解决的核心问题：

1. **动态性与时间信息的利用**：
   - 静态图链接预测方法通常忽略了网络演化的时间维度。
   - 在动态网络中，图结构随时间变化，链接的创建和删除可能与时间相关。例如，某些节点对在特定时间段内的交互更活跃。

2. **非线性与复杂动态模式**：
   - 现实世界的动态网络常包含 **非线性模式**，如周期性波动（例如股票市场的季节性变动）或快速变化的趋势（例如新技术兴起）。
   - 现有许多模型假设网络演化是平滑或线性的，难以适应这些复杂动态。

3. **局部与全局信息的平衡**：
   - 链接的形成往往依赖于节点的局部邻域特性（例如共有邻居的数量）。
   - 但动态网络中，不同区域可能有不同的变化规律（例如某些社区正在扩大，而其他社区正在收缩）。

4. **数据稀疏性与高维性**：
   - 网络的时间序列数据可能稀疏，尤其是在较短时间段内。
   - 同时，网络的特征维度可能非常高，使得直接建模变得不可行。

5. **模型泛化性与理论保障**：
   - 很多现有方法依赖启发式规则，例如计算共享邻居、路径长度等，但这些规则缺乏理论支持。
   - 需要一种模型能够在保持预测性能的同时提供理论上的一致性证明。

---

### **本文的目标**
为了克服上述挑战，本文致力于开发一个 **非参数动态链接预测模型**，其核心目标包括：

1. **弱假设建模**：设计一个非参数模型，对网络生成过程仅作弱假设，从而适应更广泛的动态模式。
2. **充分利用局部邻域与时间信息**：通过结合节点局部邻域的特征与时间序列动态，捕捉复杂的非线性变化。
3. **一致性理论证明**：确保模型在数据量足够大时能够收敛于真实的链接生成概率。
4. **高效可扩展**：采用局部敏感哈希（LSH）等技术，使得算法能够扩展到大规模图和长时间序列。

---

### **具体解决的核心问题**
1. **如何在动态网络中结合时间信息和节点特征进行预测？**
   - 本文提出通过滑动时间窗口模型，将时间序列信息融入节点邻域特征的表示中。
   
2. **如何处理非线性和复杂动态模式？**
   - 提出了一个基于核回归的非参数方法，能够捕捉季节性变化和快速波动等非线性模式。
   
3. **如何在稀疏、高维的动态网络上实现高效计算？**
   - 引入局部敏感哈希技术，加速核回归计算，显著降低计算复杂度。

通过解决上述问题，本文不仅在实验中验证了其模型的实际应用价值，还为动态网络链接预测提供了一个具有理论保障的通用方法框架。

---

文中提到的几种基线方法（如 CN、CN-all 等）是链接预测任务中常用的启发式算法。这些方法基于图的拓扑结构，使用不同的规则对节点对之间形成链接的可能性进行评分。以下是文中提到的基线方法的具体含义和它们的工作机制：

---

### **1. CN（Common Neighbors，公共邻居）**
- **定义**：
  - 评分节点对 \((i, j)\) 是否可能形成链接的方法，计算节点 \(i\) 和 \(j\) 的共同邻居数量。
  - **公式**：  
    \( \text{CN}(i, j) = |\Gamma(i) \cap \Gamma(j)| \)  
    其中，\(\Gamma(i)\) 表示节点 \(i\) 的邻居集合。

- **适用场景**：
  - 假设：两个节点拥有更多共同邻居时更可能形成链接。
  - 在静态图中表现良好，但对于动态图可能表现不佳。

---

### **2. CN-all**
- **定义**：
  - 扩展自 CN，计算在所有历史快照的联合图中，节点对的公共邻居数量。
  - 目标是利用历史时间点的全局信息，而不仅仅依赖最近的时间点。

- **优点与缺点**：
  - **优点**：在某些动态网络中，如果链接形成的模式依赖于长期的历史行为（而非最近时间点），CN-all 的表现优于 CN。
  - **缺点**：对于随时间快速变化的网络，历史快照的联合信息可能会引入噪声，导致性能下降。

---

### **3. AA（Adamic-Adar，阿达米克-阿达评分）**
- **定义**：
  - 是 CN 的加权版本，权重根据共同邻居节点的稀缺性计算。稀有邻居对节点形成链接的重要性更高。
  - **公式**：  
    \( \text{AA}(i, j) = \sum_{z \in \Gamma(i) \cap \Gamma(j)} \frac{1}{\log|\Gamma(z)|} \)  
    其中，\(|\Gamma(z)|\) 是共同邻居 \(z\) 的度数。

- **适用场景**：
  - 假设：稀有的共同邻居（具有较少的连接）比高度连接的共同邻居更重要。
  - 在社交网络或科学合作网络等稀疏图中，AA 通常优于 CN。

---

### **4. AA-all**
- **定义**：
  - 和 CN-all 类似，基于所有历史快照的联合图计算 AA 分数。

- **优点与缺点**：
  - 和 CN-all 的优缺点类似：在历史行为较重要时效果较好，但对快速动态网络可能不适用。

---

### **5. LL（Last Linkage，最后一次链接时间）**
- **定义**：
  - 基于节点对之间的“上一次链接”的时间信息进行评分。节点对越最近形成链接，评分越高。
  - **假设**：两节点越最近有交互，它们未来形成链接的可能性越高。

- **优点与缺点**：
  - **优点**：特别适用于那些遵循平滑演化模式的网络（例如，稳定的合作网络或好友关系）。
  - **缺点**：对具有季节性或非线性变化模式的网络（如股票市场）表现较差。

---

### **6. Katz**
- **定义**：
  - Katz 指数扩展了 CN 方法，考虑了节点之间的所有路径，而不仅仅是公共邻居。
  - **公式**：  
    \( \text{Katz}(i, j) = \sum_{l=1}^{\infty} \beta^l \cdot |\text{Paths}_l(i, j)| \)  
    其中，\(\text{Paths}_l(i, j)\) 表示长度为 \(l\) 的路径数，\(\beta\) 是衰减因子，抑制长路径的贡献。

- **适用场景**：
  - 假设：短路径的数量越多，节点间越可能形成链接，但长路径的影响递减。
  - **优点**：在稠密图或需要考虑间接关系的场景中有效。
  - **缺点**：计算复杂度较高，对稀疏图的表现不一定优于简单方法（如 CN）。

---

### **7. Katz-all**
- **定义**：
  - Katz 指数的扩展，基于所有历史快照的联合图计算分数。

- **优点与缺点**：
  - 同 CN-all 和 AA-all 的优缺点类似。

---

### **对比与总结**
- **静态 vs 动态**：CN、AA 和 Katz 等方法主要针对静态图，而 CN-all、AA-all 和 Katz-all 则通过考虑历史信息适配动态图。
- **启发式 vs 非参数模型**：
  - 基线方法均为启发式算法，虽然简单易用，但缺乏理论支持，难以适应复杂的动态模式（如季节性波动）。
  - 本文提出的非参数模型能够结合时间序列动态和邻域特征，在复杂动态场景（如股票市场）中大幅优于上述基线方法。

---

以 **CN-all** 为例，“*-all”方法相较于原始方法的主要区别在于如何利用 **动态网络的历史信息**。具体来说：

---

### **CN 和 CN-all 的区别**
1. **CN（Common Neighbors）**：
   - 仅考虑 **当前时间快照** \( G_T \) 中的公共邻居数量。
   - **公式**：  
     \[
     \text{CN}(i, j) = |\Gamma_T(i) \cap \Gamma_T(j)|
     \]
     其中，\(\Gamma_T(i)\) 表示节点 \(i\) 在时间 \(T\) 的邻居集合。

   - **优点**：
     - 只使用最近的信息，能反映当前网络结构下的潜在链接。
   - **缺点**：
     - 忽略了节点间在过去时间点的交互记录，如果某些链接的形成受长期历史影响，则 CN 方法可能失效。

2. **CN-all**：
   - 考虑 **所有历史快照的联合图**（即，时间序列网络的“累积视角”）。
   - **公式**：  
     \[
     \text{CN-all}(i, j) = |\Gamma_{\text{all}}(i) \cap \Gamma_{\text{all}}(j)|
     \]
     其中，\(\Gamma_{\text{all}}(i)\) 表示节点 \(i\) 在所有历史快照中的邻居集合（即 \(\Gamma_{\text{all}}(i) = \bigcup_{t=1}^{T} \Gamma_t(i)\)）。

   - **优点**：
     - 利用全历史数据，能够捕捉过去发生但在当前快照中已消失的潜在链接模式。
     - 特别适用于那些 **长期关系稳定** 或 **历史行为重要** 的网络（如学术合作网络）。
   - **缺点**：
     - 如果网络变化快速（如社区动态剧烈变化），全历史信息可能引入过多噪声，导致误导。

---

### **直观理解**
假设动态网络代表一个社交网络，节点为用户，边为好友关系：
- 在 **CN** 中，仅使用当前网络快照 \( G_T \) 来计算公共好友。比如，节点 \(i\) 和 \(j\) 的共同好友是当下仍保持好友关系的用户。
- 在 **CN-all** 中，考虑了用户之间的 **历史好友关系**。即便当前没有直接连接，但只要曾经在任何时间点有共同好友，这些历史信息都被纳入考虑。

---

### **例子说明**
假设动态网络有 3 个时间快照 \( G_1, G_2, G_3 \)，图中节点及其邻居如下：
- 时间 \(t=1\)：\(\Gamma_1(A) = \{B, C\}\), \(\Gamma_1(D) = \{C\}\)
- 时间 \(t=2\)：\(\Gamma_2(A) = \{B, E\}\), \(\Gamma_2(D) = \{E\}\)
- 时间 \(t=3\)：\(\Gamma_3(A) = \{F\}\), \(\Gamma_3(D) = \{F\}\)

对于节点对 \(A\) 和 \(D\)：
1. **CN 方法**：仅考虑当前快照 \(G_3\) 中的公共邻居：
   \[
   \text{CN}(A, D) = |\Gamma_3(A) \cap \Gamma_3(D)| = |\{F\} \cap \{F\}| = 1
   \]

2. **CN-all 方法**：考虑所有时间点的邻居集合：
   \[
   \Gamma_{\text{all}}(A) = \Gamma_1(A) \cup \Gamma_2(A) \cup \Gamma_3(A) = \{B, C, E, F\}
   \]
   \[
   \Gamma_{\text{all}}(D) = \Gamma_1(D) \cup \Gamma_2(D) \cup \Gamma_3(D) = \{C, E, F\}
   \]
   \[
   \text{CN-all}(A, D) = |\Gamma_{\text{all}}(A) \cap \Gamma_{\text{all}}(D)| = |\{C, E, F\}| = 3
   \]

**差异**：
- **CN** 只考虑当前快照中的邻居信息，认为 \(A\) 和 \(D\) 的公共邻居只有 \(F\)。
- **CN-all** 则综合所有历史快照，认为 \(A\) 和 \(D\) 的公共邻居是 \(\{C, E, F\}\)。

---

### **适用场景对比**
- **CN 的适用场景**：
  - 网络关系变化迅速，历史信息不可靠时更有效。
  - 例如实时社交网络或股票市场。

- **CN-all 的适用场景**：
  - 网络关系随时间演化较慢，历史行为重要时表现更好。
  - 例如学术合作网络或长期社交关系网络。

---

### **总结**
CN-all 扩展了 CN 的时间范围，利用了动态网络中的历史信息。这种方法适用于那些网络关系演化缓慢，历史行为对于链接形成有重要作用的场景。然而，在快速变化的网络中，全历史信息可能引入不必要的噪声，因此需要根据场景选择合适的方法。

---

本文提出了一种 **非参数动态链接预测模型（Nonparametric Link Prediction Model）**，专门用于解决动态网络中链接预测的挑战。以下是该方法的详细解释：

---

### **1. 方法的总体框架**
本文方法通过结合 **时间信息** 和 **节点局部邻域特征**，在动态网络中预测节点对未来形成链接的概率。其核心思想是：
- 将动态网络视为一系列 **时间快照** 的序列 \(\{G_1, G_2, ..., G_T\}\)。
- 使用非参数建模方法，在无需强分布假设的情况下，学习节点对链接行为的动态变化模式。
- 基于 **局部邻域特征的演化**，捕捉复杂的动态模式（如非线性或季节性波动）。

---

### **2. 主要模型假设**
1. **局部依赖假设**：
   - 假设每个节点的链接行为仅取决于其局部邻域，而不是整个图的全局信息。
   - 节点 \(i\) 的邻域 \(N_t(i)\) 定义为：节点 \(i\) 在时间 \(t\) 的 **2跳范围内的节点及其边**。
   - 节点对 \((i, j)\) 的链接行为由其邻域特征的动态变化决定。

2. **时间窗口建模**：
   - 在时间 \(t\)，节点 \(i\) 的邻域演化由滑动时间窗口 \(\{\mathbf{N}_{t-p}(i), ..., \mathbf{N}_t(i)\}\) 描述，其中 \(p\) 是窗口大小。
   - 这种建模类似于时间序列分析中的滑动窗口方法。

3. **非参数核回归**：
   - 链接概率由非参数核回归方法估计，无需预先假设网络的生成分布。
   - 核函数根据邻域相似性进行加权，从历史数据中学习动态模式。

---

### **3. 模型的具体公式**
本文模型预测节点对 \((i, j)\) 在时间 \(t+1\) 的链接概率 \(Y_{t+1}(i, j)\)，假设其服从 **Bernoulli 分布**：
\[
Y_{t+1}(i, j) \sim \text{Bernoulli}(g(\psi_t(i, j))),
\]
其中：
- \(g(\cdot)\) 是一个概率映射函数（估计节点对链接的概率）。
- \(\psi_t(i, j)\) 是一组特征，由节点对特征 \(s_t(i, j)\) 和节点 \(i\) 的局部邻域特征 \(d_t(i)\) 组成：
  \[
  \psi_t(i, j) = \{s_t(i, j), d_t(i)\}.
  \]

---

#### **特征的定义**
1. **节点对特征 \(s_t(i, j)\)**：
   - 表示节点对 \((i, j)\) 的关系特性，如：
     - 共有邻居数（Common Neighbors）。
     - 最近一次链接时间（Last Link Time）。
   - 在本文实验中，设定为：
     \[
     s_t(i, j) = \{\text{cnt}(i, j), \text{``time since last link''}(i, j)\},
     \]
     其中 cnt 表示公共邻居数量。

2. **局部邻域特征 \(d_t(i)\)**：
   - 表示节点 \(i\) 在时间 \(t\) 的邻域特性，通过一个“多维数据立方体（datacube）”编码。
   - \(d_t(i)\) 的每一维对应一个特征 \(s\)，并统计：
     - 邻域中具有特征 \(s\) 的节点对数量（\(\eta_t^i(s)\)）。
     - 这些节点对在下一个时间点 \(t+1\) 形成链接的数量（\(\eta_t^{i+}(s)\)）。
   - 数据立方体的内容为：
     \[
     d_t(i) = \{\eta_t^i(s), \eta_t^{i+}(s) \, \forall s \}.
     \]

---

#### **核回归估计器**
模型使用非参数核回归估计节点对链接的概率：
\[
\hat{g}(\psi_t(i, j)) = \frac{\sum_{t', i', j'} \text{Sim}(\psi_t(i, j), \psi_{t'}(i', j')) \cdot Y_{t'+1}(i', j')}{\sum_{t', i', j'} \text{Sim}(\psi_t(i, j), \psi_{t'}(i', j'))},
\]
其中：
- \(\text{Sim}(\psi_t(i, j), \psi_{t'}(i', j'))\) 是特征相似性权重，分解为：
  \[
  \text{Sim}(\psi_t(i, j), \psi_{t'}(i', j')) = K(d_t(i), d_{t'}(i')) \cdot \mathbf{1}\{s_t(i, j) = s_{t'}(i', j')\}.
  \]
  - \(K(d_t(i), d_{t'}(i'))\)：邻域之间的相似性，用 **总变差距离**（Total Variation Distance）衡量。
  - \(\mathbf{1}\{s_t(i, j) = s_{t'}(i', j')\}\)：节点对特征是否完全匹配。

---

### **4. 方法的实现优化**
直接计算核回归的代价很高（需遍历所有历史数据）。为了提高效率，本文引入 **局部敏感哈希（LSH, Locality Sensitive Hashing）**，快速查找最相似的邻域：
1. **哈希表构建**：
   - 将邻域特征 \(d_t(i)\) 转换为位序列（bit sequence）。
   - 通过随机选择位构建多个哈希表，保证相似邻域被映射到相同的哈希桶。

2. **查询加速**：
   - 仅从哈希桶中提取候选邻域，而不是遍历整个数据集，显著减少计算量。

---

### **5. 方法的优点**
1. **非参数化**：
   - 无需对网络生成过程作强假设，能够适应复杂的动态模式（如非线性变化、季节性波动）。

2. **灵活性**：
   - 模型不仅利用拓扑特性，还能整合外部特征（如节点标签或属性）。

3. **一致性保证**：
   - 利用核回归的一致性理论，证明模型在样本量足够大时能够收敛于真实的链接概率。

4. **高效性**：
   - 使用 LSH 实现快速近邻搜索，支持大规模图和长时间序列。

---

### **6. 实验验证**
- **仿真实验**：验证了方法在处理非线性变化（如季节性波动）时的优越性。
- **真实数据**：在传感器网络、学术合作网络和股市相关性图等动态网络中，方法表现优于现有基线方法。

---

### **总结**
本文提出的非参数方法通过结合时间信息和局部邻域特征，成功解决了动态网络链接预测中的复杂性和非线性挑战，并通过 LSH 提升了计算效率。它是动态图分析中具有理论保障和实用价值的通用方法框架。