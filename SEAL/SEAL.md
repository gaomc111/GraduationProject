# SEAL

> Link Prediction Based on Graph Neural Networks
> <https://github.com/muhanzhang/SEAL>

## 问题
1. Katz指数和PageRank在评分函数上，一个是路径数，一个是路径概率，有什么区别
2. 既然SEAL提出的γ-衰减启发式理论已经证明多步之后的信息作用不大，为什么还需要全局的启发式

## 贡献
- 提出：节点重要性随距离指数衰减，前k跳已经可以逼近全图 
- 操作：将节点距离，节点嵌入加入节点特征矩阵X，随后应用正常GNN
- 实验：3跳以上性能不会增加

## SEAL
SEAL（Subgraphs, Embeddings, and Attributes for Link prediction）是一种基于图神经网络（Graph Neural Network, GNN）的链路预测框架，旨在通过从局部子图中学习一般图结构特征来预测链路。以下是SEAL的模型结构和原理的详细解析：

---

### **1. SEAL的基本思想**
SEAL的核心思想是从目标链路周围的局部封闭子图中学习链路是否存在的特征，而非使用预定义的启发式方法。它通过GNN对这些局部子图的特征进行自动学习，使得模型可以捕获与当前网络相关的链路模式。

---

### **2. SEAL的模型结构**
SEAL分为以下三个主要步骤：

#### **2.1. 局部子图提取**
- **封闭子图定义**：围绕目标节点对 \((x, y)\) 提取的局部子图，包含所有距离 \(h\) 跳以内的邻居节点及其连接关系。
- **目标**：捕获目标链路周围的局部结构特征。
- **理论支持**：文章提出的γ-衰减启发式理论证明，局部子图已经包含了足够的信息来逼近各种高阶启发式。

#### **2.2. 节点信息矩阵构建**
提取的子图信息通过节点信息矩阵 \(X\) 表示，包含以下三个部分：
1. **结构性节点标记（Structural Node Labels）**：
   - 采用**双半径节点标记**（Double-Radius Node Labeling, DRNL）方法：
     - 为目标节点对 \((x, y)\) 赋予标记“1”。
     - 根据节点到目标节点的距离分配标记，例如距离分别为 (1,1) 的节点标记为“2”。
     - 标记反映了节点相对于目标链路的位置与结构重要性。
   - 作用：帮助GNN识别目标链路及其周围结构差异。

2. **潜在特征（Latent Features）**：
   - 如通过网络嵌入方法（如node2vec）生成的节点嵌入。
   - 提供全局网络结构信息。
   - **负注入**：将G（V，E）视为G（V，E+En），其中E是图中有的边，En是采样的负样本，以防止模型泛化性差

3. **显式特征（Explicit Features）**：
   - 节点的外部属性，如社会网络中的用户信息。

#### **2.3. 图神经网络（GNN）学习**
- **输入**：每个子图的邻接矩阵 \(A\) 和节点信息矩阵 \(X\)。
- **GNN架构**：
  - 采用**图卷积层（Graph Convolutional Layers）**：提取子图的局部结构特征。
  - 结合**图聚合层（Graph Aggregation Layers）**：通过聚合节点级别特征生成子图级别特征向量。
- **输出**：预测目标节点对是否存在链路。
- 默认使用DGCNN（Deep Graph Convolutional Neural Network）作为GNN架构，其中包含**SortPooling**层，进一步优化了子图的特征学习能力。

---

### **3. SEAL的关键创新**
#### **3.1. γ-衰减启发式理论**
- 证明了高阶启发式可以通过局部子图进行有效逼近。
- 提出在多数情况下，仅需要较小的 \(h\) 值（如1-2跳）即可获得足够的链路预测信息。

#### **3.2. DRNL节点标记**
- 设计了一种高效的节点标记方法，能够完美区分节点的结构角色，并通过闭式计算优化标记效率。

#### **3.3. 负采样嵌入（Negative Injection）**
- 在生成节点嵌入时，临时引入负样本的假链路，避免GNN直接通过存在性信息过拟合，提高泛化性能。

#### **3.4. 多特征联合学习**
- 同时利用了图结构特征、潜在特征和显式特征，增强了模型对复杂网络结构的适应能力。

---

### **4. SEAL的优势**
- **高效性**：通过局部子图学习，无需处理整个网络，显著降低计算复杂度。
- **灵活性**：支持结合不同的特征来源（如结构特征和节点属性）。
- **性能优越**：实验表明，SEAL在多种网络数据集上大幅超越传统方法和现有嵌入方法。

---

### **5. 实验结果**
SEAL在多个数据集（如社交网络、生物网络、电力网等）上的AUC和准确率均优于传统启发式方法和潜在特征方法，如Katz、PageRank、SimRank、DeepWalk等。

---

总之，SEAL模型通过创新的理论基础和高效的实现方式，为链路预测问题提供了一种全面、灵活且性能优越的解决方案。

## γ-衰减启发式理论

**γ-衰减启发式理论**是文章中提出的一种理论框架，用于解释和统一各种链路预测启发式方法，并为从局部子图中学习高阶链路特征提供理论支持。以下是该理论的详细解释：

---

### **1. 理论背景与动机**
- 链路预测启发式方法（如公共邻居、Katz指数）通过一些固定公式计算节点对之间的相似度，以预测是否存在链路。
- 高阶启发式方法（如Katz指数、SimRank）通常涉及整个网络，计算复杂度高。
- 本文提出，局部子图中已经包含了足够的信息，可以有效逼近高阶启发式方法，而无需处理整个网络。

**γ-衰减启发式理论**提供了一个统一框架，解释了为什么仅依赖局部子图就可以有效地逼近高阶启发式。

---

### **2. γ-衰减启发式的定义**
#### **公式表达**
γ-衰减启发式的形式如下：

\[
H(x, y) = \eta \sum_{l=1}^{\infty} \gamma^l f(x, y, l)
\]

其中：
- \(H(x, y)\)：目标链路（\(x, y\)）的启发式评分。
- \(\eta\)：一个正常数或与\(\gamma\)相关的函数。
- \(f(x, y, l)\)：长度为\(l\)的某种函数，描述了\((x, y)\)在网络中某种关系的强度。
- \(\gamma\)：衰减因子（\(0 < \gamma < 1\)），用于为远距离结构赋予更小的权重。

**核心思想**：\(\gamma^l\)的指数衰减特性表明，远离目标节点对的网络结构对链路预测的重要性呈指数级下降。这意味着仅需要考虑局部子图，就可以捕捉链路的关键信息。

---

### **3. 理论核心：局部子图对γ-衰减启发式的逼近**
#### **定理：γ-衰减启发式的近似性**
对于满足以下条件的函数 \(f(x, y, l)\)：
1. **条件1（有界性）**：\(f(x, y, l) \leq \lambda^l\)，其中\(\lambda < \frac{1}{\gamma}\)。
2. **条件2（可计算性）**：对于\(l \leq g(h)\)（\(g(h) = ah + b\)，\(a, b \in \mathbb{N}\)且\(a > 0\)），\(f(x, y, l)\)可从\(h\)-跳局部子图中计算。

则\(\gamma\)-衰减启发式可以通过\(h\)-跳局部子图逼近，其逼近误差至多以指数速度衰减：
\[
|H(x, y) - H_h(x, y)| \leq \eta (\gamma \lambda)^{ah + b + 1}(1 - \gamma \lambda)^{-1}
\]

**推论**：通过选择合适的\(h\)，可以高效地从局部子图中逼近高阶启发式，避免处理整个网络。

---

### **4. γ-衰减启发式的适用性**
文章进一步证明，许多常见的高阶启发式都属于γ-衰减启发式的范畴，并满足上述条件：

#### **4.1. Katz指数**
- Katz指数定义为：
  \[
  \text{Katz}(x, y) = \sum_{l=1}^\infty \beta^l |walks^{(l)}(x, y)|
  \]
  其中\(|walks^{(l)}(x, y)|\)表示节点对\((x, y)\)之间长度为\(l\)的路径数量，\(\beta\)是衰减因子。
- Katz指数是γ-衰减启发式的特例：
  - \(\gamma = \beta\)
  - \(f(x, y, l) = |walks^{(l)}(x, y)|\)

#### **4.2. PageRank**
- 根节点PageRank的链路预测得分：
  \[
  \text{PR}(x, y) = (1-\alpha) \sum_{l=1}^\infty \sum_{w:x\to y}^{|w|=l} P[w]\alpha^l
  \]
  其中\(|w| = l\)表示路径长度为\(l\)，\(P[w]\)是路径的概率。
- PageRank也属于γ-衰减启发式：
  - \(\gamma = \alpha\)
  - \(f(x, y, l) = \sum_{w:x \to y}^{|w|=l} P[w]\)

#### **4.3. SimRank**
- SimRank定义为：
  \[
  \text{SimRank}(x, y) = \gamma \sum_{a \in \Gamma(x)} \sum_{b \in \Gamma(y)} \text{SimRank}(a, b) / |\Gamma(x)||\Gamma(y)|
  \]
  其中\(\Gamma(x)\)表示节点\(x\)的邻居集合。
- SimRank也可以被归入γ-衰减启发式框架。

---

### **5. γ-衰减启发式理论的意义**
1. **统一性**：
   - γ-衰减启发式框架将多个高阶链路预测方法（如Katz、PageRank和SimRank）纳入同一数学框架。
   - 提供了分析这些方法内在机制的理论工具。

2. **局部性**：
   - 理论证明了从局部子图中学习链路预测启发式是可行且高效的。
   - 不需要访问整个网络，大大降低了计算复杂度。

3. **实践价值**：
   - γ-衰减理论为SEAL等数据驱动方法提供了理论基础，使其能够通过局部结构学习出高效的链路预测模型。

---

### **6. 总结**
γ-衰减启发式理论通过数学推导证明，高阶链路预测方法可以在局部子图中被有效逼近。它的提出不仅为链路预测领域提供了统一的理论框架，也为SEAL等基于局部子图学习的模型奠定了理论基础，有助于提高链路预测的效率和准确性。