### **利用 Word2Vec 训练嵌入的过程**  

**核心思想**：  
随机游走方法（如 DeepWalk、Node2Vec）会在图上生成多个**节点序列**，这些序列与**自然语言中的句子**类似。因此，可以使用 **Word2Vec** 这样的**词向量训练方法**，将每个**节点映射到一个低维向量**，从而学习节点之间的关系。  

---

### **1. 随机游走生成“节点序列”**
首先，在图上执行多个**随机游走（Random Walks）**，得到一组节点序列。例如，给定如下图结构：
```
A - B - C
|   |
D - E
```
随机游走可能会生成以下“句子”：
```
A B C E
D A B
E B C
```
这里的每个**节点**相当于 NLP 任务中的**单词**，整个游走序列相当于一个“句子”。

---

### **2. Word2Vec 训练节点表示**
**目标**：学习每个节点的**向量表示 \( z_v \)**，使得连接的节点在向量空间中靠近。

#### **方法 1：Skip-Gram**
- **核心思想**：给定一个**目标节点**，预测其**上下文节点**。  
- **公式**：
  \[
  \max \sum_{v \in V} \sum_{u \in N(v)} \log P(u | v)
  \]
  其中：
  - \( v \) 是目标节点（当前词）。
  - \( N(v) \) 是窗口大小 \( k \) 内的**邻居节点**（上下文词）。
  - 目标是最大化 \( v \) 预测其邻居 \( u \) 的概率。  

- **示例**：
  - 训练数据：假设窗口大小 \( k = 2 \)，那么序列 `A B C E` 会被拆分为：
    ```
    (B → A), (B → C), (C → B), (C → E), (E → C)
    ```
  - 这些样本用于训练神经网络，让 B 预测 A、C，C 预测 B、E，等等。

#### **方法 2：CBOW（Continuous Bag of Words）**
- **核心思想**：**用上下文预测目标节点**（与 Skip-Gram 相反）。  
- **公式**：
  \[
  \max \sum_{v \in V} \sum_{u \in N(v)} \log P(v | u)
  \]
  - 给定邻居节点，预测中心节点。  
  - 适用于**数据量大的情况**，比 Skip-Gram 训练更快。

- **示例**：
  - 训练数据：窗口大小 \( k = 2 \)，序列 `A B C E` 会被拆分为：
    ```
    (A, C → B), (B, E → C)
    ```
  - 这里，模型使用 A 和 C 共同预测 B，B 和 E 共同预测 C。

---

### **3. 计算嵌入向量**
- 训练完成后，每个节点 \( v \) 都会被映射到一个**低维向量 \( z_v \)**：
  \[
  z_v \in \mathbb{R}^d, \quad d \ll |V|
  \]
- 这个向量可以用来**计算节点相似性**，比如：
  \[
  \text{Similarity}(z_A, z_B) = z_A \cdot z_B
  \]
  - **相似度高**：意味着两个节点在网络中具有**相似的连接模式**。  
  - **相似度低**：意味着两个节点关系较弱。

---

### **4. 训练过程总结**
1. **随机游走**：在图上生成多个节点序列（模拟“句子”）。
2. **Word2Vec 训练**：
   - **Skip-Gram**：给定节点，预测邻居（推荐用于稀疏图）。
   - **CBOW**：给定邻居，预测节点（训练更快）。
3. **获得节点嵌入**：每个节点被映射到一个低维向量，可用于**节点分类、链接预测、聚类**等任务。

---

### **5. 直观理解**
- **类比 NLP**：  
  - 在 Word2Vec 中，“词语的语境决定其含义”。
  - 在随机游走中，“节点的邻居决定其嵌入表示”。
- **效果**：
  - 结构相似的节点会有**相似的向量表示**，即便它们不直接相连。
  - 例如，在社交网络中，**兴趣相同但不直接连接的用户**可能会有类似的嵌入。  

---

### **6. 总结**
- **随机游走 + Word2Vec = 图嵌入学习的核心方法**。  
- **DeepWalk/Node2Vec 通过 Word2Vec 训练嵌入，使得结构相似的节点在向量空间中接近**。  
- **Skip-Gram 更适合稀疏图，CBOW 训练更快但信息可能丢失**。  
- 生成的节点向量可用于**分类、链接预测、聚类**等任务。