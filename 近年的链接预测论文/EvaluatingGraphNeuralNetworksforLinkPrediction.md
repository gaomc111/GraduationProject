# Evaluating Graph Neural Networks for Link Prediction: Current Pitfalls and New Benchmarking
Juanhui Li, Harry Shomer, Haitao Mao, Shenglai Zeng, Yao Ma, Neil Shah, Jiliang Tang, Dawei Yin

## 简述
- 本文要解决的问题
  当前GNN评估的有效性存在的问题
  1. **性能低估**：许多模型在基线上的表现被低估，主要由于超参数调优不当。
  2. **缺乏统一的数据划分和评估指标**：不同研究使用不同的数据划分和评估指标，难以进行有效比较。
  3. **不现实的评估设置**：当前使用的随机负样本设置使得任务过于简单，未能反映实际场景。
- 本文提出的内容
    **启发式相关采样技术（HeaRT）**，通过为每个正样本定制负样本，避免了使用随机选择的负样本所带来的评价不准确问题。

---

本文探讨了图神经网络（GNN）在链接预测任务中的应用，分析了当前评估方法存在的多个问题，并提出了新的评估基准。链接预测旨在根据图中已知的边预测未见边的存在。尽管近年来提出了多种GNN方法和新的数据集，但评估的有效性受到以下问题的影响：

1. **性能低估**：许多模型在基线上的表现被低估，主要由于超参数调优不当。
2. **缺乏统一的数据划分和评估指标**：不同研究使用不同的数据划分和评估指标，难以进行有效比较。
3. **不现实的评估设置**：当前使用的随机负样本设置使得任务过于简单，未能反映实际场景。

为此，本文首先进行了公平的模型比较，确保使用相同的数据集和超参数设置。然后，提出了一种基于启发式相关采样技术（HeaRT）的评估方法，该方法通过为每个正样本选择相关的难负样本，提升了评估的挑战性和实用性。最终，研究结果表明，新的评估设置更好地反映了模型在现实场景中的表现。

---

1. **本文想要解决的问题**  
   本文旨在解决当前图神经网络（GNN）在链路预测任务中的评价不足，主要包括三个方面的陷阱：模型性能低于实际表现、缺乏统一的数据划分和评价指标，以及不切实际的评价设置，使用简单的负样本进行评估。

2. **本文使用的方法解决这一问题**  
   本文提出了一种新的评价设置，称为启发式相关采样技术（HeaRT），该方法通过为每个正样本定制负样本，避免了使用随机选择的负样本所带来的评价不准确问题。此外，本文进行了公平的模型比较，确保所有模型在相同的超参数和数据集条件下进行评估。

3. **本文达到了什么样的优秀结果，或本文相比其同类产品的优势在哪**  
   本文的研究显示，经过合理的超参数调优后，多个模型的性能显著高于以往研究报告的结果。例如，Neo-GNN在ogbl-collab数据集上的Hits@50达到了66.13，显著超越了之前的57.52。这表明，本文的方法能够更准确地反映模型的真实表现，提供了对现有链路预测方法的更全面的基准测试。与同类研究相比，本文的优势在于采用了一致的评价标准和更具现实意义的负样本生成策略，提高了模型评估的准确性和可靠性。

---

本文提出的评价设置主要聚焦于解决传统链路预测评估中的不足，具体包括以下几个方面：

### 1. **问题识别**

传统的链路预测评价设置使用相同的负样本集合来评估所有正样本。这种方法存在以下问题：
- **非个性化的负样本**：所有正样本使用相同的负样本，无法反映实际应用中链路预测的个性化需求。
- **简单的负样本，使得任务过于轻松**：当前的负样本通常在结构上与正样本无关，这使得模型容易分类，无法真实反映模型的性能。

### 2. **新评价设置：启发式相关采样技术（HeaRT）**

为了解决上述问题，本文提出了HeaRT方法，具体包括以下步骤：

- **定制负样本生成**：对每个正样本，生成与之相关的负样本。这些负样本是在正样本的基础上，通过引入一个或两个节点的腐败生成的。这种方法确保负样本在结构上与正样本更为相关，从而使链路预测任务更加具有挑战性。

- **使用多种启发式规则**：在选择负样本时，HeaRT结合了多种启发式规则，以确定哪些负样本最具挑战性和相关性。这一过程使得生成的负样本能够更好地反映真实场景中的链路预测需求。

### 3. **更具现实意义的评价**

通过引入定制的负样本，本文的评价设置更贴近实际应用场景。例如，在社交网络中，链路预测任务往往涉及为特定用户推荐朋友。新的评价设置允许模型在评估时更准确地考虑用户的特定社交环境，从而提高了预测的有效性和准确性。

### 4. **实施与结果**

在实施过程中，本文对比了传统和新的评价设置下模型的表现，结果显示，新的设置显著提高了模型的评估准确性，减少了高标准差的问题，提供了更可靠的性能指标。这使得本文在链路预测领域建立了一个更为全面和科学的基准测试方法。

### 总结

总体而言，本文的评价设置通过个性化的负样本生成和多种启发式规则的结合，克服了传统评价设置中的多个陷阱，提供了一种更具挑战性和现实意义的评估方式，极大地促进了链路预测模型的评估和比较。